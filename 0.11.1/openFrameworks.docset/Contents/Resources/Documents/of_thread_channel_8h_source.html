<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.3.1"/>
    <a class="dashingAutolink" name="autolink-781"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/openFrameworks%3A%20Class%20Index"></a><title>openFrameworks: Class Index</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript">
      $(document).ready(function() { searchBox.OnSelectItem(0); });
    </script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="content">
      <div id="body-wrap">
      		<div class="page-wide">
	            <div class="page-left-split">
           		    <h1 class="documentation">reference</h1> <ul class="docsadvanced"><li><a href="documentation">basic</a></li> <li><a class="active" href="doxygen/annotated.html">advanced</a></li> </ul>
           		</div>
		        <div class="page-right-narrow">
			        <p>This documentation is automatically generated from the openFrameworks source code using doxygen and refers to the most recent release, version <strong>0.11.1</strong>.</p>
		        </div>
       		</div>
      		<div class="page-wide">
      		    <div class="doxy-mainmenu">
<!-- Generated by Doxygen 1.9.1 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_84d5b34cee6369a03c8d1f3b970ed216.html">openFrameworks</a></li><li class="navelem"><a class="el" href="dir_526ceb304abbba6426340f0fa9170dbd.html">utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ofThreadChannel.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="of_thread_channel_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&nbsp;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&nbsp; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&nbsp; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&nbsp;<span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&nbsp;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&nbsp;<span class="preprocessor">#include &lt;condition_variable&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&nbsp; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&nbsp; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&nbsp;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classof_thread_channel.html">   31</a></span>&nbsp;<span class="keyword">class </span><a class="code" href="classof_thread_channel.html">ofThreadChannel</a>{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&nbsp;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#ac79bc884d85268a505f2be51aeac3026">   39</a></span>&nbsp;    <a class="code" href="classof_thread_channel.html#ac79bc884d85268a505f2be51aeac3026">ofThreadChannel</a>()</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&nbsp;    :closed(false){}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&nbsp; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#ab0ec065ab911ac8932ebec5ba38631a9">   68</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#ab0ec065ab911ac8932ebec5ba38631a9">receive</a>(T &amp; sentValue){</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&nbsp;        <span class="keywordflow">if</span>(closed){</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&nbsp;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&nbsp;        <span class="keywordflow">while</span>(queue.empty() &amp;&amp; !closed){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&nbsp;            condition.wait(lock);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&nbsp;        }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&nbsp;        <span class="keywordflow">if</span>(!closed){</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&nbsp;            <a class="code" href="namespacestd.html#a08edfd20a72c3d81da8646e1fced27dc">std::swap</a>(sentValue,queue.front());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&nbsp;            queue.pop();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&nbsp;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&nbsp;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&nbsp;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&nbsp; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#a15f344aab7986a00a1dc04033f70d067">  115</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#a15f344aab7986a00a1dc04033f70d067">tryReceive</a>(T &amp; sentValue){</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&nbsp;        <span class="keywordflow">if</span>(closed){</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&nbsp;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&nbsp;        <span class="keywordflow">if</span>(!queue.empty()){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&nbsp;            <a class="code" href="namespacestd.html#a08edfd20a72c3d81da8646e1fced27dc">std::swap</a>(sentValue,queue.front());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&nbsp;            queue.pop();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&nbsp;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&nbsp;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&nbsp;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&nbsp; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#a3ee7f9bd6509f050fa0647968227b467">  161</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#a3ee7f9bd6509f050fa0647968227b467">tryReceive</a>(T &amp; sentValue, int64_t timeoutMs){</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&nbsp;        <span class="keywordflow">if</span>(closed){</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&nbsp;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&nbsp;        <span class="keywordflow">if</span>(queue.empty()){</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&nbsp;            condition.wait_for(lock, std::chrono::milliseconds(timeoutMs));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&nbsp;            <span class="keywordflow">if</span>(queue.empty()) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&nbsp;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&nbsp;            }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&nbsp;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&nbsp; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&nbsp;        <span class="keywordflow">if</span>(!closed){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&nbsp;            <a class="code" href="namespacestd.html#a08edfd20a72c3d81da8646e1fced27dc">std::swap</a>(sentValue,queue.front());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&nbsp;            queue.pop();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&nbsp;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&nbsp;        }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&nbsp;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&nbsp; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#aeb559f365f7fee7a6bdc6322e30683a5">  208</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#aeb559f365f7fee7a6bdc6322e30683a5">send</a>(<span class="keyword">const</span> T &amp; value){</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&nbsp;        <span class="keywordflow">if</span>(closed){</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&nbsp;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&nbsp;        queue.push(value);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&nbsp;        condition.notify_one();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&nbsp;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&nbsp;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&nbsp; </div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#aca886ede85aeeec6eae19516ac9e05d2">  249</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#aca886ede85aeeec6eae19516ac9e05d2">send</a>(T &amp;&amp; value){</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&nbsp;        <span class="keywordflow">if</span>(closed){</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&nbsp;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&nbsp;        }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&nbsp;        queue.push(std::move(value));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&nbsp;        condition.notify_one();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&nbsp;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&nbsp;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&nbsp; </div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#a8d3caa95ca10cffbee462cbbe23ab228">  265</a></span>&nbsp;    <span class="keywordtype">void</span> <a class="code" href="classof_thread_channel.html#a8d3caa95ca10cffbee462cbbe23ab228">close</a>(){</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&nbsp;        std::unique_lock&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&nbsp;        closed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&nbsp;        condition.notify_all();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&nbsp;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&nbsp; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&nbsp; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classof_thread_channel.html#a1488e97723c04c2c382d000b3f4613f1">  277</a></span>&nbsp;    <span class="keywordtype">bool</span> <a class="code" href="classof_thread_channel.html#a1488e97723c04c2c382d000b3f4613f1">empty</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&nbsp;        <span class="keywordflow">return</span> queue.empty();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&nbsp;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&nbsp; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&nbsp;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&nbsp;    std::queue&lt;T&gt; queue;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&nbsp; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&nbsp;    std::mutex mutex;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&nbsp; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&nbsp;    std::condition_variable condition;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&nbsp; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&nbsp;    <span class="keywordtype">bool</span> closed;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&nbsp; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&nbsp;};</div>
<div class="ttc" id="aclassof_thread_channel_html"><div class="ttname"><a href="classof_thread_channel.html">ofThreadChannel</a></div><div class="ttdoc">Safely send data between threads without additional synchronization.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:31</div></div>
<div class="ttc" id="aclassof_thread_channel_html_a1488e97723c04c2c382d000b3f4613f1"><div class="ttname"><a href="classof_thread_channel.html#a1488e97723c04c2c382d000b3f4613f1">ofThreadChannel::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Queries empty channel.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:277</div></div>
<div class="ttc" id="aclassof_thread_channel_html_a15f344aab7986a00a1dc04033f70d067"><div class="ttname"><a href="classof_thread_channel.html#a15f344aab7986a00a1dc04033f70d067">ofThreadChannel::tryReceive</a></div><div class="ttdeci">bool tryReceive(T &amp;sentValue)</div><div class="ttdoc">If available, receive a new sent value without blocking.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:115</div></div>
<div class="ttc" id="aclassof_thread_channel_html_a3ee7f9bd6509f050fa0647968227b467"><div class="ttname"><a href="classof_thread_channel.html#a3ee7f9bd6509f050fa0647968227b467">ofThreadChannel::tryReceive</a></div><div class="ttdeci">bool tryReceive(T &amp;sentValue, int64_t timeoutMs)</div><div class="ttdoc">If available, receive a new sent value or wait for a user-specified duration.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:161</div></div>
<div class="ttc" id="aclassof_thread_channel_html_a8d3caa95ca10cffbee462cbbe23ab228"><div class="ttname"><a href="classof_thread_channel.html#a8d3caa95ca10cffbee462cbbe23ab228">ofThreadChannel::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">Close the ofThreadChannel.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:265</div></div>
<div class="ttc" id="aclassof_thread_channel_html_ab0ec065ab911ac8932ebec5ba38631a9"><div class="ttname"><a href="classof_thread_channel.html#ab0ec065ab911ac8932ebec5ba38631a9">ofThreadChannel::receive</a></div><div class="ttdeci">bool receive(T &amp;sentValue)</div><div class="ttdoc">Block the receiving thread until a new sent value is available.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:68</div></div>
<div class="ttc" id="aclassof_thread_channel_html_ac79bc884d85268a505f2be51aeac3026"><div class="ttname"><a href="classof_thread_channel.html#ac79bc884d85268a505f2be51aeac3026">ofThreadChannel::ofThreadChannel</a></div><div class="ttdeci">ofThreadChannel()</div><div class="ttdoc">Create a default ofThreadChannel.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:39</div></div>
<div class="ttc" id="aclassof_thread_channel_html_aca886ede85aeeec6eae19516ac9e05d2"><div class="ttname"><a href="classof_thread_channel.html#aca886ede85aeeec6eae19516ac9e05d2">ofThreadChannel::send</a></div><div class="ttdeci">bool send(T &amp;&amp;value)</div><div class="ttdoc">Send a value to the receiver without making a copy.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:249</div></div>
<div class="ttc" id="aclassof_thread_channel_html_aeb559f365f7fee7a6bdc6322e30683a5"><div class="ttname"><a href="classof_thread_channel.html#aeb559f365f7fee7a6bdc6322e30683a5">ofThreadChannel::send</a></div><div class="ttdeci">bool send(const T &amp;value)</div><div class="ttdoc">Send a value to the receiver by making a copy.</div><div class="ttdef"><b>Definition:</b> ofThreadChannel.h:208</div></div>
<div class="ttc" id="anamespacestd_html_a08edfd20a72c3d81da8646e1fced27dc"><div class="ttname"><a href="namespacestd.html#a08edfd20a72c3d81da8646e1fced27dc">std::swap</a></div><div class="ttdeci">void swap(ofPixels_&lt; PixelType &gt; &amp;src, ofPixels_&lt; PixelType &gt; &amp;dst)</div><div class="ttdef"><b>Definition:</b> ofPixels.h:1493</div></div>
</div><!-- fragment --></div><!-- contents -->

            </div>
      </div>
      <div id="footer">
        <a href="http://openframeworks.cc/">openFrameworks</a> Documentation, generated by Doxygen.
      </div> <!-- End Footer -->
    </div> <!-- End Content -->
  

</body></html>